
db.createCollection("orders")



db.orders.insertMany([
  { id: "A1", amount: 400, status: "P" },
  { id: "B1", amount: 300, status: "D" },
  { id: "A1", amount: 200, status: "F" },
  { id: "C1", amount: 200, status: "F" },
  { id: "B1", amount: 700, status: "P" },
  { id: "B1", amount: 800, status: "P" }
])


print("\nğŸ”¹ Sum of 'Pending' (P) amounts for each customer:")
db.orders.aggregate([
  { $match: { status: "P" } },
  { $group: { _id: "$id", total_amount: { $sum: "$amount" } } }
])



print("\nğŸ”¹ Average amount per customer:")
db.orders.aggregate([
  { $group: { _id: "$id", avg_amount: { $avg: "$amount" } } }
])



print("\nğŸ”¹ Minimum amount per customer:")
db.orders.aggregate([
  { $group: { _id: "$id", min_amount: { $min: "$amount" } } }
])



print("\nğŸ”¹ Maximum 'Failed' (F) amount for each customer:")
db.orders.aggregate([
  { $match: { status: "F" } },
  { $group: { _id: "$id", max_amount: { $max: "$amount" } } }
])
